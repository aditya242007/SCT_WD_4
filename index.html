<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>To-Do Web App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap' rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #111827;
            color: #F9FAFB;
        }
        .glassmorphism {
            background: rgba(31,41,55,0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .actions { opacity: 0; transition: opacity .3s; }
        .task-item:hover .actions { opacity: 1; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #4B5563; border-radius: 4px; }
        .light { background: #F9FAFB; color: #111827; }
        .light .glassmorphism { background: rgba(255,255,255,0.7); border: 1px solid #eee; }
        /* Priority tag styles */
        .priority-tag {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 9999px;
            font-size: 0.9em;
            font-weight: 600;
            margin-right: 8px;
        }
        .priority-low { background: #22c55e; color: #fff; }
        .priority-medium { background: #fbbf24; color: #fff; }
        .priority-high { background: #ef4444; color: #fff; }
    </style>
</head>
<body>

<div style="max-width:600px;margin:40px auto 0;">
    <!-- Header -->
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:2rem;">
        <div style="display:flex;align-items:center;gap:1rem;">
            <div style="background:#6366f1;padding:10px;border-radius:10px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 24 24"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
            </div>
            <h1 style="font-size:2rem;font-weight:bold;">My Tasks</h1>
        </div>
        <button id="theme-toggle" style="padding:8px;border-radius:50%;background:none;border:none;">
            <svg id="theme-toggle-dark-icon" width="24" height="24" class="hidden" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
            <svg id="theme-toggle-light-icon" width="24" height="24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="5" stroke-width="2"/><path stroke-width="2" d="M12 1v2m0 18v2m11-11h-2M3 12H1m16.95 7.07l-1.41-1.41M6.34 6.34L4.93 4.93m12.02 0l-1.41 1.41M6.34 17.66l-1.41 1.41"/></svg>
        </button>
    </div>

    
    <div class="glassmorphism" style="padding:1.5rem;border-radius:1rem;margin-bottom:2rem;">
        <form id="task-form" style="display:grid;gap:1rem;grid-template-columns:1fr 1fr;">
            <input type="text" id="task-name-input" placeholder="Add a new task..." style="grid-column:span 2;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;color:#fff;">
            <input type="datetime-local" id="task-datetime-input" style="background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;color:#fff;">
            <!-- Priority select  -->
            <select id="task-priority-input" style="background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;color:#fff;grid-column:span 2;">
                <option value="low">Low Priority</option>
                <option value="medium">Medium Priority</option>
                <option value="high">High Priority</option>
            </select>
            <!-- Note input -->
            <input type="text" id="task-note-input" placeholder="Add a note (optional)" style="grid-column:span 2;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;color:#fff;">
            <button type="submit" style="grid-column:span 2;background:#6366f1;color:#fff;font-weight:bold;padding:12px;border-radius:8px;border:none;">Add Task</button>
        </form>
    </div>

    
    <main id="task-list-container" style="display:flex;flex-direction:column;gap:1rem;"></main>

    <!-- Edit Modal with priority tag only -->
    <div id="edit-task-modal" style="position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:10;display:none;">
        <div class="glassmorphism" style="padding:2rem;border-radius:1rem;width:100%;max-width:400px;">
            <h2 style="font-size:1.5rem;font-weight:bold;margin-bottom:1rem;">Edit Task</h2>
            <form id="edit-task-form">
                <input type="hidden" id="edit-task-id-input">
                <input type="text" id="edit-task-name-input" style="width:100%;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;margin-bottom:1rem;color:#fff;">
                <input type="datetime-local" id="edit-task-datetime-input" style="width:100%;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;margin-bottom:1rem;color:#fff;">
                <select id="edit-task-priority-input" style="width:100%;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;margin-bottom:1rem;color:#fff;">
                    <option value="low">Low Priority</option>
                    <option value="medium">Medium Priority</option>
                    <option value="high">High Priority</option>
                </select>
                <input type="text" id="edit-task-note-input" placeholder="Edit note (optional)" style="width:100%;background:#374151;border:1px solid #4B5563;border-radius:8px;padding:12px;margin-bottom:1rem;color:#fff;">
                <div style="display:flex;justify-content:flex-end;gap:1rem;">
                    <button type="button" id="cancel-edit-button" style="background:#4B5563;color:#fff;font-weight:bold;padding:8px 16px;border-radius:8px;border:none;">Cancel</button>
                    <button type="submit" style="background:#6366f1;color:#fff;font-weight:bold;padding:8px 16px;border-radius:8px;border:none;">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// DOM loaded hone ke baad sab kaam yahan se start hoga
document.addEventListener('DOMContentLoaded', function() {
    // sabhi input aur button ko yahan pakad lo
    var taskForm = document.getElementById('task-form');
    var taskNameInput = document.getElementById('task-name-input');
    var taskDatetimeInput = document.getElementById('task-datetime-input');
    var taskPriorityInput = document.getElementById('task-priority-input');
    var taskNoteInput = document.getElementById('task-note-input');
    var taskListContainer = document.getElementById('task-list-container');
    var editTaskModal = document.getElementById('edit-task-modal');
    var editTaskForm = document.getElementById('edit-task-form');
    var editTaskIdInput = document.getElementById('edit-task-id-input');
    var editTaskNameInput = document.getElementById('edit-task-name-input');
    var editTaskDatetimeInput = document.getElementById('edit-task-datetime-input');
    var editTaskPriorityInput = document.getElementById('edit-task-priority-input');
    var editTaskNoteInput = document.getElementById('edit-task-note-input');
    var cancelEditButton = document.getElementById('cancel-edit-button');
    var themeToggleButton = document.getElementById('theme-toggle');
    var darkIcon = document.getElementById('theme-toggle-dark-icon');
    var lightIcon = document.getElementById('theme-toggle-light-icon');

    // tasks array localStorage se load karo
    var tasks = [];
    if (localStorage.getItem('tasks')) {
        try {
            tasks = JSON.parse(localStorage.getItem('tasks'));
        } catch (e) {
            tasks = [];
        }
    }

    // theme set karne ka function
    function setTheme(theme) {
        if (theme === 'light') {
            document.body.classList.add('light');
            darkIcon.classList.remove('hidden');
            lightIcon.classList.add('hidden');
        } else {
            document.body.classList.remove('light');
            darkIcon.classList.add('hidden');
            lightIcon.classList.remove('hidden');
        }
    }

    // tasks ko localStorage me save karo
    function saveTasks() {
        localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    // confetti dikhane ka function jab koi task complete ho jaye
    function showConfetti() {
        var confetti = document.createElement('div');
        confetti.innerHTML = '🎉';
        confetti.style.position = 'fixed';
        confetti.style.left = '50%';
        confetti.style.top = '50%';
        confetti.style.fontSize = '3rem';
        confetti.style.transform = 'translate(-50%, -50%)';
        confetti.style.zIndex = 9999;
        document.body.appendChild(confetti);
        setTimeout(function() {
            confetti.remove();
        }, 1200);
    }

    // tasks ko UI me dikhane ka kaam
    function renderTasks() {
        taskListContainer.innerHTML = '';
        if (tasks.length === 0) {
            taskListContainer.innerHTML = '<p style="text-align:center;color:#9CA3AF;">No tasks yet. Add one above!</p>';
            saveTasks();
            return;
        }

        // date ke hisaab se sort karo
        tasks.sort(function(a, b) {
            if (a.datetime && b.datetime) {
                return new Date(a.datetime) - new Date(b.datetime);
            }
            if (a.datetime) return -1;
            if (b.datetime) return 1;
            return b.id - a.id;
        });

        for (var i = 0; i < tasks.length; i++) {
            var task = tasks[i];
            var div = document.createElement('div');
            div.className = 'task-item glassmorphism';
            div.style = 'padding:1rem;border-radius:10px;display:flex;align-items:center;justify-content:space-between;' + (task.completed ? 'opacity:0.5;' : '');
            div.dataset.id = task.id;

            var dateStr = '';
            if (task.datetime) {
                var d = new Date(task.datetime);
                dateStr = d.toLocaleString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
            }

            // priority tag class nikal lo
            var priorityClass = {
                low: "priority-tag priority-low",
                medium: "priority-tag priority-medium",
                high: "priority-tag priority-high"
            }[task.priority || "low"];
            var priorityLabel = {
                low: "Low",
                medium: "Medium",
                high: "High"
            }[task.priority || "low"];

            div.innerHTML = `
                <div style="display:flex;align-items:center;gap:1rem;">
                    <input type="checkbox" style="width:20px;height:20px;" ${task.completed ? 'checked' : ''}>
                    <div>
                        <p style="font-weight:500;color:#fff;${task.completed ? 'text-decoration:line-through;' : ''}">
                            <span class="${priorityClass}">${priorityLabel} Priority</span>
                            ${task.text}
                        </p>
                        ${task.note ? `<p style="font-size:0.95em;color:#fbbf24;">📝 ${task.note}</p>` : ''}
                        ${dateStr ? `<p style="font-size:0.9em;color:#9CA3AF;">${dateStr}</p>` : ''}
                    </div>
                </div>
                <div class="actions" style="display:flex;align-items:center;gap:0.5rem;">
                    <button class="edit-btn" style="color:#60a5fa;background:none;border:none;padding:6px;border-radius:50%;">✏️</button>
                    <button class="delete-btn" style="color:#f87171;background:none;border:none;padding:6px;border-radius:50%;">🗑️</button>
                </div>
            `;
            taskListContainer.appendChild(div);
        }
        saveTasks();
    }

    // naya task add karne ka kaam
    taskForm.addEventListener('submit', function(e) {
        e.preventDefault();
        var text = taskNameInput.value.trim();
        if (!text) return;
        var newTask = {
            id: Date.now(),
            text: text,
            completed: false,
            datetime: taskDatetimeInput.value ? taskDatetimeInput.value : null,
            priority: taskPriorityInput.value,
            note: taskNoteInput.value.trim()
        };
        tasks.push(newTask);
        taskNameInput.value = '';
        taskDatetimeInput.value = '';
        taskPriorityInput.value = 'low';
        taskNoteInput.value = '';
        renderTasks();
    });

    // task list pe click events handle karo (edit, delete, complete)
    taskListContainer.addEventListener('click', function(e) {
        var target = e.target;
        var item = target.closest('.task-item');
        if (!item) return;
        var id = Number(item.dataset.id);
        var task = tasks.find(function(t) { return t.id === id; });

        if (target.type === 'checkbox') {
            task.completed = target.checked;
            renderTasks();
            // agar complete hua to confetti dikhao
            if (task.completed) {
                showConfetti();
            }
        } else if (target.classList.contains('delete-btn')) {
            tasks = tasks.filter(function(t) { return t.id !== id; });
            renderTasks();
        } else if (target.classList.contains('edit-btn')) {
            editTaskIdInput.value = task.id;
            editTaskNameInput.value = task.text;
            if (task.datetime) {
                var d = new Date(task.datetime);
                var iso = new Date(d.getTime() - (d.getTimezoneOffset() * 60000)).toISOString();
                editTaskDatetimeInput.value = iso.substring(0, 16);
            } else {
                editTaskDatetimeInput.value = '';
            }
            editTaskPriorityInput.value = task.priority || 'low';
            editTaskNoteInput.value = task.note || '';
            editTaskModal.style.display = 'flex';
        }
    });

    // edit modal me save karne ka kaam
    editTaskForm.addEventListener('submit', function(e) {
        e.preventDefault();
        var id = Number(editTaskIdInput.value);
        var task = tasks.find(function(t) { return t.id === id; });
        if (task) {
            task.text = editTaskNameInput.value.trim();
            task.datetime = editTaskDatetimeInput.value ? editTaskDatetimeInput.value : null;
            task.priority = editTaskPriorityInput.value;
            task.note = editTaskNoteInput.value.trim();
        }
        editTaskModal.style.display = 'none';
        renderTasks();
    });

    // edit modal band karne ka button
    cancelEditButton.addEventListener('click', function() {
        editTaskModal.style.display = 'none';
    });

    // theme toggle ka kaam
    themeToggleButton.addEventListener('click', function() {
        var isLight = document.body.classList.toggle('light');
        var theme = isLight ? 'light' : 'dark';
        localStorage.setItem('theme', theme);
        setTheme(theme);
    });

    // page load pe theme set karo aur tasks dikhado
    var savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme);
    renderTasks();
});
</script>
</body>
</html>